(function() {
/////////////////////// BEGIN MAIN SCRIPT /////////////////////

// Variables that point to each textarea by ID.
  var htmlBox = document.getElementById('html'),
      cssBox = document.getElementById('css'),
      jsBox = document.getElementById('js');

// Textarea variables are placed into an array.
  var arr = [htmlBox, cssBox, jsBox];

// forEach loop used on array to apply keydown, keyup
// EventListeners and to invoke render function.
  arr.forEach(function(box) {

    // Makes tab key indent within textarea.
    // box.addEventListener('keydown', function(t) {
    //   if (t.keyCode === 9) {
    //     var start = this.selectionStart,
    //         end = this.selectionEnd,
    //         target = t.target,
    //         value = target.value;
    //
    //     target.value = value.substring(0, start) + '\t' + value.substring(end);
    //
    //     this.selectionStart = this.selectionEnd = start + 1;
    //
    //     t.preventDefault();
    //   }
    // }, false);

    // Used to invoke render function on each keyup event
    box.addEventListener('keyup', function() {
      render();
    });
  });

// Render function used to obtain textarea values and output
// code into designated iframe.
  var render = function() {

    // Variables assigned to textarea values.
    var html = htmlBox.value,
        css = cssBox.value,
        js = jsBox.value,

        // Selects iframe as output and returns document object
        // that is generated by the iframe.
        output = document.querySelector('#output').contentDocument;

    // The open method opens output stream for the write method.
    // Once all write methods have completed, close method closes
    // the output stream and displays written data.
    output.open();
    output.write('<!DOCTYPE html>');
    output.write('<html>');
    output.write('<head>');
    output.write('<style>' + css + '</style>');
    output.write('</head>');
    output.write('<body>');
    output.write(html);
    output.write('<script type="text/javascript">' + js + '</script>');
    output.write('</body>');
    output.write('</html>');
    output.close();
  };

  /////////////////////// END MAIN SCRIPT /////////////////////
})();
